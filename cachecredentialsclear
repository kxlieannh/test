# Clear local credential caches
cmdkey /list | ForEach-Object {
    if ($_ -match "Target:") {
        $target = ($_ -split ":")[1].Trim()
        cmdkey /delete:$target
    }
}

# Clear Windows Credential Manager entries for domain
Remove-Item -Path "$env:LOCALAPPDATA\Microsoft\Credentials" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "$env:APPDATA\Microsoft\Credentials" -Recurse -Force -ErrorAction SilentlyContinue
